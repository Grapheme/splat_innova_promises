<?php $__env->startSection('content'); ?>

    <?php echo $__env->make($module['tpl'].'/menu', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>

	<?php if($count = @count($elements)): ?>

        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 pos-rel">
                <table class="table table-striped table-bordered min-table white-bg pos-rel">
                    <thead>
                        <tr>
                            <th class="text-center" style="width:40px">#</th>
                            <th style="width:100%;"class="text-center"><?php echo $dic->name_title ?: 'Название'; ?></th>
                            <?php if($actions_column): ?>
                            <th colspan="2" class="width-250 text-center">Действия</th>
                            <?php endif; ?>
                        </tr>
                    </thead>
                    <tbody class="dicvals <?php if($sortable): ?> sortable <?php endif; ?>">

                    <?php echo Helper::d_(Input::all()); ?>

                    <?php echo Helper::d_( Helper::multiArrayToAttributes(Input::get('filter'), 'filter') ); ?>


                    <?php foreach($elements as $e => $element): ?>
                        <? #continue; ?>
                        <tr <?php if($sortable): ?> data-id="<?php echo $element->id; ?>" <?php endif; ?>>
                            <td class="text-center">
                                <?php echo $e+1; ?>

                            </td>
                            <td>
                                <?
                                $line = $element->name;
                                if (isset($dic_settings['first_line_modifier']) && is_callable($dic_settings['first_line_modifier']))
                                    $line = $dic_settings['first_line_modifier']($line, $dic, $element);
                                ?>
                                <?php echo $line; ?>

                                <br/>
                                <span class="note dicval_note">
                                <?
                                $line = $element->slug;
                                if (isset($dic_settings['second_line_modifier']) && is_callable($dic_settings['second_line_modifier']))
                                    $line = $dic_settings['second_line_modifier']($line, $dic, $element);
                                ?>
                                <?php echo $line; ?>

                                </span>
                            </td>

                            <?php if($actions_column): ?>
                            <td class="text-center" style="white-space:nowrap;">

                                <?php if(NULL != ($actions = @$dic_settings['actions']) && @is_callable($actions)): ?>
                                    <?php echo $actions($dic, $element); ?>

                                <?php endif; ?>

                                <?php if(Allow::action($module['group'], 'dicval_edit')): ?>
                                <a href="<?php echo action(is_numeric($dic_id) ? 'dicval.edit' : 'entity.edit', array('dic_id' => $dic_id, 'id' => $element->id)) . (Request::getQueryString() ? '?' . Request::getQueryString() : ''); ?>" class="btn btn-success">
                                    Изменить
                                </a>
                                <?php endif; ?>

                                <?php if(
                                    Allow::action($module['group'], 'dicval_delete')
                                    && (
                                            !isset($dic_settings['min_elements'])
                                            || ($dic_settings['min_elements'] > 0 && $total_elements > $dic_settings['min_elements'])
                                        )
                                ): ?>
                                <form method="POST" action="<?php echo action(is_numeric($dic_id) ? 'dicval.destroy' : 'entity.destroy', array('dic_id' => $dic_id, 'id' => $element->id)); ?>" style="display:inline-block">
                                    <button type="submit" class="btn btn-danger remove-record">
                                        Удалить
                                    </button>
                                </form>
                                <?php endif; ?>

                            </td>
                            <?php endif; ?>

                        </tr>
                    <?php endforeach; ?>
                    </tbody>
                </table>
            </div>
        </div>

        <?php if($dic->pagination > 0): ?>
            <?php echo $elements->links(); ?>

        <?php endif; ?>

	<?php else: ?>

        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="ajax-notifications custom">
                    <div class="alert alert-transparent">
                        <h4>Список пуст</h4>
                        <p><br><i class="regular-color-light fa fa-th-list fa-3x"></i></p>
                    </div>
                </div>
            </div>
        </div>

	<?php endif; ?>

<?php $__env->stopSection(); ?>


<?php $__env->startSection('scripts'); ?>
    <script>
    var essence = 'record';
    var essence_name = 'запись';
	var validation_rules = {
		name: { required: true }
	};
	var validation_messages = {
		name: { required: 'Укажите название' }
	};
    </script>

	<?php echo HTML::script('private/js/modules/standard.js'); ?>


	<script type="text/javascript">
		if(typeof pageSetUp === 'function'){pageSetUp();}
		if(typeof runFormValidation === 'function'){
			loadScript("<?php echo asset('private/js/vendor/jquery-form.min.js');; ?>", runFormValidation);
		}else{
			loadScript("<?php echo asset('private/js/vendor/jquery-form.min.js');; ?>");
		}
	</script>

    <?php if($sortable): ?>
    <script>
        init_sortable("<?php echo URL::route('dicval.order'); ?>", ".dicvals");
    </script>
    <?php endif; ?>

    <?php if(@trim($dic_settings['javascript'])): ?>
    <script>
        <?php echo @$dic_settings['javascript']; ?>

    </script>
    <?php endif; ?>

<?php $__env->stopSection(); ?>


<?php echo $__env->make(Helper::acclayout(), array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>