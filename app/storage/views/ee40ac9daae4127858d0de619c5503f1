<?
$years = array();
foreach ($news as $new) {
    $years[date('Y', strtotime($new->published_at))] = 1;
}
?>

        <?php if(isset($news) && is_object($news) && $news->count()): ?>
        <ul class="js-tabs year-tabs" data-tabs="news">
            <?php foreach($years as $year => $null): ?>
            <li<?php echo date('Y') == $year ? ' class="active"' : ''; ?> data-tab="<?php echo $year; ?>"><span><?php echo $year; ?></span>
            <?php endforeach; ?>
        </ul>
        <div class="js-parent" data-tabs="news">
            <?
            $last_year = false;
            ?>
            <?php foreach($news as $new): ?>
            <?
            $current_year = date('Y', strtotime($new->published_at));
            ?>
            <?php if($current_year != $last_year): ?>
            <ul data-block="<?php echo $current_year; ?>" class="js-tab news-ul">
            <?php endif; ?>
                <li>
                    <span><?php echo Helper::rdate('j M', $new->published_at); ?></span>
                    <span><?php echo $new->meta->preview; ?></span>
            <?php if($current_year != $last_year): ?>
                <?
                $last_year = $current_year;
                ?>
                </ul>
                <?php endif; ?>
            <?php endforeach; ?>
        </div>
        <?php endif; ?>
