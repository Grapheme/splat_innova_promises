
<aside id="left-panel">
	<nav>
		<ul>
    	<?php foreach(SystemModules::getSidebarModules() as $name => $module): ?>
<? #echo (string)Request::segment(2) . " == " . $module['link'] . " > " . (int)((string)Request::segment(2) == $module['link']); ?>
<? #dd(Request::segment(2)); ?>
<?php
#Helper::d($_SERVER['REQUEST_URI']);
#Helper::d("/" . AuthAccount::getStartPage($module['link']));
#Helper::d( (string)Request::segment(2)."/".(string)Request::segment(3) . " == " . $module['link'] );
#Helper::d( $module );
#Helper::d(URL::to(AuthAccount::getStartPage().'/'.$module['link']));
#Helper::d( $module['link']  == (string)Request::segment(2)."/".(string)Request::segment(3) );
$menu_child_active = false;
$class = false;
if (
    $module['link'] == (string)Request::segment(2) ## pages
    || $module['link'] == (string)Request::segment(2)."/".(string)Request::segment(3) ## 48hours/places
    #|| @$_SERVER['REQUEST_URI'] == "/" . AuthAccount::getStartPage($module['link']) ## admin/48hours/places
)
    #$class = 'active';
    $menu_child_active = "active open";
$have_childs = isset($module['menu_child']) && is_array($module['menu_child']) && count($module['menu_child']);
?>
			<li class='<?php echo @$menu_child_active; ?>'>
				<a href="<?php echo URL::to(link::auth($module['link'])); ?>" title="<?php echo e($module['title']); ?>"<?php echo (isset($module['menu_child']) && !empty($module['menu_child']) && $module['link'] == '#') ? ' onclick="return false;"' : ''; ?>>
					<i class="fa fa-lg fa-fw <?php echo $module['class']; ?>">
                        <?php if(@is_callable($module['icon_badge'])): ?>
                            <?php echo $module['icon_badge'](); ?>

                        <?php endif; ?>
					</i>
                    <span class="menu-item-parent"><?php echo e($module['title']); ?></span>
                    <?php if(@is_callable($module['badge'])): ?>
                        <?php echo $module['badge'](); ?>

                    <?php endif; ?>
                    <?php if($have_childs): ?>
                    <?php /* <b class="collapse-sign"><em class="fa fa-plus-square-o"></em></b> */ ?>
                    <?php endif; ?>
				</a>
			    <?php if($have_childs): ?>
				<ul<?php echo $menu_child_active ? ' style="display:block;"' : ''; ?>>
				    <?php foreach($module['menu_child'] as $child_name => $child_module): ?>
<? #echo Request::segment(3) . " == " . $child_module['link'] . " > " . (int)(Request::segment(3) == $child_module['link']); ?>

					<li class="sidebar_child_menu<?php echo (
                            (Request::segment(2) != '' && Request::segment(2) == $child_module['link'])
                            || (Request::segment(2) != '' && Request::segment(3) != '' && Request::segment(2)."/".Request::segment(3) == $child_module['link'])
                            || strpos($_SERVER['REQUEST_URI'], $child_module['link'])
                        )
                        ? ' active'
                        : ''; ?>">
						<a href="<?php echo URL::to(link::auth($child_module['link'])); ?>" title="<?php echo e($child_module['title']); ?>">
							<i class="fa fa-lg fa-fw <?php echo $child_module['class']; ?>"></i> <span class="menu-item-parent"><?php echo e($child_module['title']); ?></span>
						</a>
					</li>
				    <?php endforeach; ?>
				</ul>
			    <?php endif; ?>
			</li>
    	<?php endforeach; ?>
		</ul>
	</nav>
	<span class="minifyme"> <i class="fa fa-arrow-circle-left hit"></i> </span>
</aside>
